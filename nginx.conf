worker_processes  auto;  # Automatically determine the number of worker processes based on the number of CPU cores.

events {
    worker_connections  1024;  # Maximum number of simultaneous connections per worker process.
    multi_accept        on;  # Allow the worker to accept multiple connections at once, improving performance.
}

http {
    include       mime.types;  # Include MIME types definitions.
    default_type  application/octet-stream;  # Default MIME type for requests without a known extension.

    sendfile        on;  # Enable the sendfile feature for better performance.
    tcp_nopush      on;  # Avoid sending small packets.
    tcp_nodelay     on;  # Enable Nagle algorithm disabling for better latency.
    keepalive_timeout  65;  # Keepalive timeout for idle connections.
    types_hash_max_size 2048;  # Increase the maximum size of the hash table for MIME types.

    gzip  on;  # Enable gzip compression to reduce the size of transmitted data.
    gzip_disable "msie6";  # Disable gzip compression for MSIE 6 to avoid issues.
    gzip_vary on;  # Send Vary header to inform proxies about compressed responses.
    gzip_proxied any;  # Compress responses even if they are proxied.
    gzip_comp_level 6;  # Compression level between 1 (fastest) and 9 (best compression).
    gzip_buffers 16 8k;  # Number of buffers and buffer size for compressing output.
    gzip_http_version 1.1;  # Use HTTP 1.1 for gzip compression.
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;  # Types of content to compress.

    server {
        listen       80;  # Listen on port 80.
        server_name  localhost;  # Server name for this virtual host.

        # Enable access and error logs
        access_log  /var/log/nginx/access.log;
        error_log   /var/log/nginx/error.log;

        # Redirect server error pages to the static page /50x.html
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }

        location / {
            root   /usr/share/nginx/html;
            index  index.html index.htm;

            # Enable expires headers for caching
            expires 30d;
        }

        # Serve static assets with a longer cache control header
        location ~* \.(jpg|jpeg|png|gif|css|js|ico|xml)$ {
            access_log off;
            log_not_found off;
            expires max;
            add_header Cache-Control "public, no-transform, immutable, s-maxage=31536000, max-age=31536000";
        }
    }
}